% !TEX root = main.tex
\chapter{Auditing Blockchain-based Assets} \label{sec:auditing}


\begin{quote}
	\textit{This chapter is based on the paper ``Systemizing the Challenges of Auditing Blockchain-Based Assets''~\cite{pimentel2021systemizing} published on American Accounting Association Journal of Information Systems. This paper was supervised by Jeremy Clark, and co-authored by Erica Pimentel and Emilio Boulianne}
	% TODO: change this to reflect the contribution and modifications

\end{quote}


%TODO a paragraph connecting this chapter to the previous chapter or the theme of the thesis

This chapter is slightly different than the previous chapters. In all previous chapters, we focused on the technical aspects of the blockchain ecosystem, and how they can result in unforeseen consequences. In this chapter, we will focus on the financial auditing process of blockchain-based assets (cryptoassets), and how the technical nuances of the blockchain ecosystem can result in challenges for the auditors. These challenges are important to address as they can result in inaccurate financial statements, and potentially misleading investors and other stakeholders.


% Auditing <— as a chapter 
% ConsenSys diligence work —> borrow from auditing paper with Erica, illusion of chapter is paper reviewed but adding the framework of the existence, evaluation, ownership, internal control weave in stuff from code review and and CTO stuff. (no on the interviews)

% shine on what people do, for crypto auditing. <— (wait on Jeremy for a paper)
% —> what is manual audit, you still need it. framwork of the OEInternal controls, what could go wrong ! what about airdrops for the balance, get from the vasanth paper add stuff
% what can be done 
% borrow from the FC version auditing paper <— 


% Based on published work but my opinions?

% Financial audit <> code review audit


%++++++++++++++++++++++=======================================+++++++++++++++++++++
% Similar to frontrunning paper sections
\section{Introduction} \label{sec:auditing:intro}

The blockchain industry is comprised of firms (raising more than \$15B in unregulated funding and \$2.5B in venture capital in 2018~\cite{coindesk2018}) that issue and manage cryptoassets (worth a combined \$1.64T at the time of writing~\cite{coinmarketcap}). While this market is experiencing rapid growth, it is dominated by startups that lack the financial sophistication and maturity of similarly valued traditional firms, and that rely on outside funding to develop and grow. These small firms will require audited financial statements to obtain traditional forms of credit such as bank loans or to gain access to public markets. For instance, SEC registrants must file audited financial statements that have an unqualified audit opinion (except under limited circumstances)~\cite{securities2009financial}. If registrants are unable to provide unqualified audited statements, they will be unable to raise capital on public markets. At the time of writing, auditing firms are hesitant to provide audit opinions to the blockchain sector. Furthermore, several crypto companies such as Impak Finance (who undertook the first legal ICO in Canada~\cite{AMFImpactFinance}), Hut 8 Mining Corp., Vogogo Inc. and DMG Blockchain Solutions Inc., were placed on cease trade for failure to produce timely financial statements when their auditors abruptly stepped down and the companies were unable to find replacement auditors~\cite{posadzki2019crypto}). Therefore, the inability to obtain audited financial statements is a pressing issue as both new and existing firms are having difficulty finding auditing firms who wish to provide opinions to crypto companies.

Our research has uncovered that major accounting firms are hesitating to provide certification in the blockchain sector due to a perception of insurmountable business risk associated with these clients. Auditors believe that due to a complex and rapidly changing technological environment, they have yet to develop the in-depth knowledge of their clients' blockchain businesses in order to perform an audit. Due to the lack of guidance, standards and regulations in this space, auditors are reticent to take on new clients in a sector that has been subject to numerous frauds~\cite{abreu2018blockchain}. Accordingly, the inability to obtain audited financial statements presents a key barrier to investment and growth in the blockchain sector.


This chapter aims to bring forth issues associated with auditing blockchain-based assets by making parallels to traditional financial statement audits. 



%++++++++++++++++++++++=======================================+++++++++++++++++++++
\section{Background} \label{sec:auditing:background}


\subsection{Ethereum Address types}
In Ethereum, there are two types of addresses: externally owned accounts (EOA) and smart contracts. EOAs are controlled by private keys and are used to send transactions on the Ethereum network. Smart contracts are accounts that are controlled by code and are used to store and execute code on the Ethereum network. 

%TODO: explain the difference between EOA and smart contract addresses


A multi-signature (multisig) account is a smart contract that requires multiple signatures to execute a transaction. Multisig smart contracts are used to increase the security of the funds by requiring multiple parties to sign a transaction. Multisigs are commonly used by companies to store their cryptoassets. There are different possible implementations and configurations on how each multisig smart contract can be set up~\cite{ittay2021wallet}. For example, a multisig smart contract can be set up to require 2 out of 3 signatures to execute a transaction. This means that if there are 3 signatories, any 2 of them can sign a transaction to execute it.

%todo: maybe worth opening this up? 
We are aware of the possibility of creating multi-signature wallets without the use of smart contracts, as an example by using MPC~\cite{zhao2019secure}, however for the purpose of this paper we will focus on the smart contract based multisig wallets.

\subsection{Cryptoassets}
We use the term cryptoasset and cryptoliability to refer to listings on a firm's balance sheet that exist and are transacted using blockchain technology and have some tradeable value. This includes cryptocurrencies (e.g., bitcoin and ether) as well as tokens (\eg ERC20) issued by smart contracts running on a blockchain. Among others, the main categories of tokens are: (1) \textit{Access tokens}: a service is developed that requires its own custom tokens for using the service; (2) \textit{Backed tokens}: a token issuer claims to be holding something valuable (material or digital) in reserve, and the token represents a claim on these reserves; (3) \textit{Equity tokens}: a firm issues tokens to represent ownership shares of the company; and (4) \textit{Collectable tokens}: the token itself is offered as a contemporary collector's item. 


\subsection{Auditing}





%++++++++++++++++++++++=======================================+++++++++++++++++++++
\section{Framework and Technical Nuances} \label{sec:auditing:framework} %TODO: maybe merge this with background or change the title
In this section, we provide a brief overview of the technical nuances of blockchain technology that are relevant to the auditing process while discussing the proposed auditing framework. We also provide a brief overview of the auditing process and the challenges that auditors face when auditing blockchain-based assets.


\subsection{Proof of Ownership}\label{sec:auditing:framework:ownership}

Auditors must be satisfied that the assets reported on the company's balance sheet do in fact belong to the company, or if the client is operating as a custodian for third-parties (for instance, as an exchange who holds cryptocurrencies received from third-parties), that the assets held do in fact belong to the third-party who claims to possess them. For traditional assets, firms might overcome the ownership issue in several ways. First, a client can demonstrate ownership of an asset with reference to a generally accepted official document. For instance, a property owner can demonstrate ownership of their building with reference to a deed. However, in a blockchain environment, no central authority exists to produce such official documents. Second, firms may engage a custodian to hold assets on their behalf, like a bank. This does not eliminate the issue of ownership but simply shifts the concern from the firm's audit to the audits of central custodians.

\begin{quote}
One of our first considerations as it relates both existence and ownership is just to think through how the entity is maintaining custody of their assets. And in particular, what's the security mechanism around access to the private key? Which can vary from being held [in many ways] from online to some type of hot storage to on a piece of paper somewhere to in a software tool that is not connected to the internet and kind of offline. Which of course, brings down the risk of it being hacked but then increases the risk of physical loss of the private key. We want to understand what our potential clients are doing related to that. Then, as many of them seem to do, we start to gather that they're using a third party around custody.~\cite{pimentel2021systemizing}
\end{quote}

Therefore, addressing whether or not a client maintains ownership over their cryptoassets will depend on whether they hold their cryptoassets themselves (self-custody) or through a custodian.


\subsubsection{Self-Custody of Assets}
In the absence of legal registers to support ownership or documents bearing the name of the firm, the auditor must rely on the internal controls of the entity to obtain comfort over the ownership assumption~\cite{pimentel2021systemizing}. A question emerges about what ownership means in this context both temporally and in terms of access to a private key. Temporally, auditors must distinguish between whether they are able to provide support for ownership over an asset at the date of conducting the audit procedure or at the end of the fiscal period under audit. For example, if an auditor verifies that a client owns bitcoin one month after year-end through procedures like signing messages or transferring small amounts to and from the key, this proves that the client controlled the asset on that date but says nothing about whether the client owned those assets at year-end. With inventory, in the absence of performing a count at year-end, the auditor may perform roll-back procedures to verify the transactions between the count date and the year-end date to obtain comfort over the year-end balance. To do so, this would require that the auditor ensure that ownership was maintained over the subsequent events period even if this is not what is required by the auditing standards: 

\begin{quote}
Do I need to prove that they retained ownership over the subsequent events period? The auditing standard doesn't say that I do. If the client loses ownership during the subsequent events period, do I need to unrecord the whole thing at year end? Likely, this would be an issue of note disclosure. In the past, this has been used before for some fraud cases, but in those cases, it was because those transactions never really occurred.
\end{quote}

Determining when to test ownership to ensure that evidence is obtained at the correct date becomes a challenge. Best practice would indicate that, like inventory, auditors should test ownership as at the balance sheet date and may wish to provide note disclosure for significant events where ownership is lost. 

A question emerges about what ownership really means in this context. A client may demonstrate that they have access to a private key, but this in and of itself does not demonstrate ownership. ``With ownership, the risk of giving someone else access to the private key is no different than the corporate controller sharing his password to the company bank account with his spouse''. Auditors must determine what types of procedures they can do to validate control and ownership in this context: 

If a client uses self-custody, we can do different procedures to be able to approve ownership like small amount transfers or secret messages, depending on the protocol they're using. 

These practices like small value transfers or the sending of secret messages are part of what are referred to as cryptographic proofs. 

\subsubsection{Cryptographic Keys} 

For most cryptoassets, the asset is considered owned by Alice if Alice possesses a private signing key that can be used to digitally sign a transfer of the asset (See Section~\ref{digital_signature}). Although alternative notions of ownership are possible to define, the idea of a signing key is foundational and seen with bitcoin, Ethereum (ETH), and ERC20 tokens. Thus, demonstrating knowledge of this key is necessary, but not sufficient, to demonstrating ownership. The most direct cryptographic technique is to use a so-called zero-knowledge proof of this private key, and to staple in some information identifying the context of the proof. For standard proofs, this is cryptographically equivalent to simply signing a challenge message with the key. Folklore protocols of sending small cash amounts from an allegedly owned account to the auditor to demonstrate control are also commonly noted in the literature. This offers similar security but may add ethical complexities for the auditor in accepting the amount transferred. 

We note that while cryptographic proof is necessary, it is not sufficient. A cryptographic proof simply demonstrates that the purported owner has access to the person holding the signing key. A malicious company might arrange for the owner of cryptoassets to engage in signing statements or moving test amounts fraudulently on their behalf. This issue is not new: an insolvent retail store might borrow inventory from elsewhere to inflate its assets during an inventory count. Auditors mitigate this by arranging a common date for all audits of physical inventory and, similarly, cryptographic audits could be synchronized on a fixed schedule to prevent the same assets from being counted for different companies in different audits~\cite{dagher2015provisions}. 

One type of proof includes sending a small amount of money to the auditor from the private key, while another proof involves demonstrating that the client can respond to a cryptographically-protected message that only the private key holder could open. Independently, neither of these procedures demonstrate that the client owns the private key. However, auditors rely on the sum of several procedures to obtain reasonable assurance over this assertion: 

\begin{quote}
With ownership, it's not a specific procedure but rather the body of evidence that can be performed by signing messages, by testing internal controls, by understanding how the client protects passwords. The clear expectation of ownership is changing. In a traditional audit, the client represents that they own certain things. We see an invoice and we see that they own it. But did they really pay for it? Was it paid for by another company and consigned to them? We perform several procedures to feel comfortable enough to say that they have ownership at that point in time. Our expectations of what ownership means in this area is evolving.
\end{quote}

Many clients are concerned about self-custody due to security risks over holding their own private keys and are turning to custodians to fulfill this function for them. Auditors must adapt their audit procedures to their clients' unique internal control environments and consider competing sources of evidence before coming to a conclusion about ownership. 

\subsubsection{Third-Party Custodianship}\label{sec:auditing:framework:ownership:custodianship}
In a traditional audit context, the reliance on a third-party custodian is commonplace. Clients might have bank accounts with multiple banks or investment accounts with various brokerage houses. Obtaining confirmations from these custodians is valued as a high-quality evidence due to its provenance from a regulated third-party. Confirmations in the cryptoasset space are not as straightforward because the entities the auditor would be requesting confirmations from, such as a crypto-exchange, are not regulated. This raises questions over the reliability of their responses. 

In order to address the reliability of the confirmations from service providers such as cryptocurrency exchanges or other types of custodians, auditors look to the robustness of the internal controls at the service organization. The robustness of these controls is evidenced by the presence of a service organization control (SOC) report. In order to rely on the controls of a service organization such as a payroll provider or investment custodian, auditors often obtain SOC reports, which provide assurance over the processes and data security at the custodian. Two types of reports are available: an SOC 1 report provides assurance over the controls used by a service provider who processes financial data; an SOC 2 report provides assurance over controls over the processing of non-financial data in accordance with Trust Services Criteria~\cite{bdosocreports}. 

While some firms have been able to obtain SOC reports, the mere fact of having the report is insufficient. Obtaining an SOC report is not a box-checking exercise and that the auditor must review the report carefully to understand which controls it has addressed and can be relied on.

A related issue to the robustness of the internal controls relates to how the custodian segregates the assets in their possession: 

\begin{quote}
We also have heard that many of these custodians are co-mingling or combining assets into a single account or wallet. That muddies the water a bit and it's difficult in some type of SOC reports to understand what they are really doing to maintain a client's assets. There's a chance that there actually are no assets. If you've given your assets to someone else to hold for you, you may think that they still are yours and that they still exist, but that can be difficult to ascertain.
\end{quote}

When evaluating whether they can rely on the representations from a custodian, the auditor should evaluate how the custodian segregates the assets in their possession. 

In short, in order for auditors to validate ownership, their procedures will depend on whether the client has custody of their keys or uses a third-party. Self-custody will depend on the client's internal controls, while reliance on a custodian will depend on the ability to obtain comfort over the reliability of the custodian. Additionally, cryptographic proofs play an important role in the ability to rely on either party. In order to avoid double-counting of keys, an industry standard common date should be arranged to provide a generally agreed upon ``state of the world'' where keyholders can demonstrate ownership. 

However, not all auditors may be as aware of the importance of SOC reports. One common method is to rely on confirmations from exchanges as a way to corroborate the existence and ownership of the client's assets, since third-party audit evidence is traditionally viewed as the highest quality of audit evidence for addressing these assertions. 

This finding raises two issues. First, auditors believing they could rely on technologists at their firm to compensate for their lack of knowledge. However, having access to expert knowledge is not the same as deploying it. As we have cautioned throughout the paper, it is incumbent on auditors to develop a fundamental knowledge of blockchain technology to be able to leverage the skills of specialized professionals. And this synergy is only possible when auditors and technologists collaborate~\cite{bauer2019one}. Second is the lack of guidance on how to audit cryptoassets. We believe that by providing rigorous sets of standards and through ongoing inspections by audit oversight bodies, a corpus of generally accepted auditing standards for this sector will develop. These standards will provide guidelines that auditors who are not blockchain experts can use when attempting to make inroads into this sector. 



\subsection{Existence} \label{sec:auditing:framework:existence}
Auditors need to establish that financial statements, as reported, are free of material misstatements. One area that was repeatedly cited as a challenging area for our respondents was the existence of cryptocurrencies. The major challenges to verifying existence are related to the reliability of a blockchain and the custodianship of assets.

\subsubsection{Reliability of a Blockchain}
One challenge of auditing the existence of cryptoassets is simply due to their non-physical nature~\cite{pimentel2021systemizing}. Unlike inventory or land that auditors can observe, auditors are required to find alternative evidence for these intangible assets. Evaluating the existence of a cryptoasset necessarily requires relying on a blockchain upon which a cryptoasset resides. Further, determining whether a given blockchain is reliable or not can prove difficult. Although blockchains are touted as immutable, not all blockchains are created equally. Hence, the ability to rely on a blockchain will depend on factors such as the robustness of the consensus mechanism, depth of the community supporting the blockchain, and reliability of the cryptography involved, among other things.
A fundamental question is the reliability of that blockchain to be used as audit evidence. Blockchain is viewed as trustless but it is still a piece of code. For instance, if we're talking Bitcoin, there is a larger community supporting it, resulting in a longer chain, more mining, more hashpower, more robust cryptography, more robust consensus mechanism, quicker resolution of forks. Not just because of the size of the community, but the manpower to resolve these issues makes the blockchain more reliable. If we're talking about an obscure altcoin, then it's something different. In that case, maybe it's a weaker protocol, a weaker consensus mechanism, or lower hashpower. There is less support.
Auditors must be able to evaluate the reliability of the blockchain they are relying on to provide evidence for the existence of cryptoassets. This is a challenge because it requires a level of technical expertise that many auditors do not possess.

The challenge lies in determining how much work is involved in validating the blockchain itself. Whether a full code review or investigation of the underlying blockchain's cryptography is necessary will be a case-by-case decision. However, this may result in duplicate work if each firm is providing an in-depth review of each blockchain for each mandate. Best practice would involve firms developing a library of blockchains which have been tested (for instance, blockchains for which a code review has been done at a certain date) and which future engagement teams within the firm network can rely on to reduce the duplication of work.

Another challenge remains determining how to rely on transactions that are not on the blockchain. For instance, many exchanges pool or commingle the accounts of several clients. In a secondary ledger (not on the blockchain), they record the positions of each client and then may record offsetting positions of those clients in this secondary ledger and not actually record the exchange on the blockchain.

Auditors must be careful when evaluating audit evidence to verify the source for their existence support. While there are procedures that will allow the auditor to rely on the blockchain to validate existence, the auditor must validate that the transaction actually took place on that blockchain. If not, the immutability of the blockchain is irrelevant.


\subsubsection{Forks and Airdrops} \label{sec:auditing:framework:existence:airdrops}
Existing accounting standards do not contemplate how to account for non-reciprocal transfers of assets like in the case of forks or airdrops. For example, in August 2017, when a hard fork created Bitcoin Cash from Bitcoin main ledger, holders of Bitcoin had two types of assets on hand. Bitcoin Cash was not paid for but resulted from a split between the two currencies. However, if existing accounting standards require the measurement of transactions at historical cost (what was paid for the assets), then recipients of Bitcoin Cash would report this new asset on their books at a value of \$0. Certainly, this does not represent the true value acquired through the fork~\cite{webb2018fork}. Therefore, auditors must address the issue of an accounting standard that does not contemplate how to measure the value of cryptoassets when considering whether the financial statements they are reporting on are accurate in all substantial respects. More commonly for ERC-20 tokens on Ethereum, the recipient of the tokens sometimes don't have the option to reject the deposits nor would get notified of the new tokens received, which could result in issues with completeness. However, in some other instances, such as Optimism Airdrop~\cite{allen2023airdrop}, the recipient of the tokens must claim the tokens in order to receive them. In this case, the auditor must ensure that the client has claimed the tokens, and the price of the time of the claim, in order to include them in the financial statements.



\subsection{Valuation of Cryptoassets} \label{sec:auditing:framework:valuation}
When values are reported on financial statements, they must be reported in the functional currency of the firm, meaning the primary governmental currency used. A challenge for blockchain entities is to determine the valuation of cryptoassets on the financial statement date or the conversion rate for sales and expenditures made throughout the year. Auditors must be satisfied that the values reported in the financial statements are accurate and represent the underlying economic reality.


\subsubsection{Fair Value of Cryptoassets}
A significant obstacle for obtaining audited financial statements is the determination of a fair value for cryptoassets. Cryptoassets are often difficult to value because it is challenging to determine their underlying value and there may not be a generally accepted, quoted value to use as a reference. As an analogy, firms value foreign currencies at the closing rate on the transaction date, as reported by the central bank servicing the firm's area. No universal central bank offers rates for currency-like cryptoassets. At the time of writing, only a few Fortune 500 financial firms, \eg CME (Chicago Mercantile Exchange), offers a daily reference rate for bitcoin and ether, but not for most cryptocurrencies or cryptoassets.
While bitcoin and ether enjoy around-the-clock trading across many markets, lesser-known coins, tokens, assets, or liabilities may trade slowly, and in low volumes. Generally speaking, low liquidity results in stale last sale prices and large bid-ask spreads. This is challenging but not unprecedented in financial auditing: privately held stocks and over-the-counter financial instruments share a similar profile. Auditors must familiarize themselves with the exchange markets for the cryptocurrencies held by their client to assist in validating their valuation.

\subsubsection{Geographical Variation}
The same cryptoasset might have different market values across different jurisdictions — because of market frictions, arbitrage does not resolve these differences~\cite{kroeger2017law}. If a firm applies International Financial Reporting Standards (IFRS), any financial assets measured at fair value that they hold must be determined with reference to their principal market (if available), which refers to the ``market with the greatest volume and level of activity for the asset''~\cite{ifrs13fairvalue}. Therefore, this standard precludes a firm from using the valuation of a cryptocurrency based on an obscure market price. Auditors will need to look carefully at the record of a client`s trading activity to determine the location of a client`s principal cryptoassets market and ensure that the assets are valued accordingly on the financial statements.



\subsection{Internal Controls and Monitoring} \label{sec:auditing:framework:internalcontrol}
Auditors must be satisfied that the financial statements they are reporting on are free of material misstatements. In order to do so, auditors must obtain reasonable assurance that the internal controls of the client are effective. This is done by testing the design and operating effectiveness of the internal controls. In the context of cryptoassets, this is challenging because the adequate internal controls are novel to the auditors, often not well documented and are not always securely automated.

It is necessary for a firm to be able to demonstrate the existence and ownership of its crypto-assets, however it must further demonstrate that it has adequate procedures in place to prevent or detect fraud and theft. Consider a firm holding DAO governance tokens. Internally, it must ensure proper controls over the signing keys these DAO tokens are assigned to. External to the firm, the DAO smart contract maintaining these tokens on Ethereum's blockchain must itself be secure (which in the case of the DAO, it was not~\cite{siegel2016daohack}). Auditing internal procedures over cryptographic keys is not unprecedented---maintaining certificate authority keys is critical to some security firm's financial prospects (a security breach at one firm, DigiNotar, bankrupted it~\cite{van2013diginotar}). However, the use of cryptographic keys is not yet commonplace in financial auditing.

As discussed in Section~\ref{sec:auditing:framework:ownership:custodianship}, auditors rely heavily on SOC reports to obtain comfort over the internal controls of a custodian. However, SOC reports are not always available, and even when they are, they do not always cover the relevant controls for custody of cryptocurrencies. SOC reports require the company to provide a description of the system, including the controls in place, and the auditor to provide an opinion on the design and operating effectiveness of the controls. However, the SOC report is not a panacea. The auditor must still evaluate the report to determine whether the controls are adequate for the purposes of the audit. Additionally, the SOC report is only as good as the date it was issued. If the SOC report is dated after the balance sheet date, the auditor must obtain additional evidence to ensure that the controls were in place at the balance sheet date.

%TODO: dig deeper here that what the SOC report requires and what it doesn't



%++++++++++++++++++++++=======================================+++++++++++++++++++++
\section{Case Studies} \label{sec:auditing:case-studies}



% here is the what the topic is

% here are the case studies: — start here! centre
% - experience of the CTO
% - experience of the auditors
% - why is the neunces 
% ===> 3 stories from dili and ethcap


% Case study 1: Proof of ownership
% —> Message signing v.s. self transferred transaction —> proof ownership
% ——> EOA v.s. multisig wallet
% 			— manual audit of the variables of the smart contract —> how are the signaturories and what code it's running, …
% —> probably find a paper or blog or something to cite



% maybe 1 example of each framework: ownership, existence, valuation, internal control 
\subsection{Case Study 1: Proof of Ownership} \label{sec:auditing:case-studies:ownership}

In the traditional auditing context, providing proof of ownership of the assets in a company's balance sheet is a common practice (See Section ~\ref{sec:auditing:framework:ownership}), usually in the form of a bank statements or a certificate of ownership. In the blockchain ecosystem, there is no bank or central authority that can provide such a statement~\cite{pimentel2021systemizing}. Instead, the owner of the assets must be able to prove ownership of the assets either by relying on a third party or themselves by using cryptographic techniques. As shortly discussed in Section~\ref{digital_signature}, this can be done by providing a digital signature from the address that holds the assets. However, due to technical nuances of blockchain ecosystem, this is not always a straightforward process. 

In order to provide proof of ownership of any cryptoasset (\eg Bitcoin, ETH, ERC20 tokens, NFTs), historically multiple approaches have been used in financial audit processes. One of the first approaches, started with self-custodial Bitcoin holdings, was to transfer a small amount of bitcoin from and back to the address that holds the assets. This approach is not only time consuming, but also has costs associated with it due to the blockchain transaction fees. Another common approach is to sign a message with the private key associated with the address (\eg digital signature) that holds the assets. This approach is more efficient and cost effective, however, requires tooling to be able to irrefutably verify the validity of the signature by the auditors~\cite{gavinwrightcourt}. Additionally, this approach is not always possible. For example, in the case of Ethereum, the address that holds the asset can be an externally owned account (EOA) or a smart contract. In the case of an EOA, the process is can be done using the digital signature verification. However, in the case of a smart contract, the process is more complicated. 

As described in Section~\ref{sec:auditing:background}, multisig smart contracts are commonly used by companies to securely store their cryptoassets. Unlike EOA addresses, smart contracts do not have a private key associated with them, hence the proof of ownership cannot be done using the digital signature verification. One approach is to fall back on the older method of transferring a small amount of the asset from and back to the smart contract address. Another is to prove the ownership by by verifying the code of the smart contract and the only verify the signatories of the multisig smart contract. This process is more complicated and requires manual auditing of the smart contract code. Additionally, the smart contract can be upgraded or the signatories of the multisig smart contract can be changed at any time, hence the proof of ownership must be done at the time of every audit, and manually verified by technical experts.

%TODO: probably some technical depth here is needed on multisig stuff




\subsection{Case Study 2: Existence} \label{sec:auditing:case-studies:existence}
As described in Section~\ref{sec:auditing:framework:existence}, the existence of cryptoassets is a challenging area for auditors. For this case study, we will focus on the example from~\ref{sec:auditing:framework:existence:airdrops} and discuss the challenges of auditing the existence of airdropped tokens, specifically Optimism~\cite{optimismgithub} Airdrop. In this section, we do not discuss what Optimism is, and how it works, and we only focus on the auditing challenges of the airdrop for the auditors and the cryptoasset holders.

The Optimism team decided to airdrop OP tokens to the Ethereum addresses that met a criteria of activity on the Ethereum mainnet (\eg part of the multisig smart contract). The airdrop was done in two phases, the first phase was done in May 2022, and the second phase was done in February 2023. The airdrop was done in a way that the recipient of the tokens must claim the tokens in order to receive them. This is different that many previously push airdrops, where the recipient of the tokens did not have the option to reject the deposits nor would get notified of the new tokens received. 

There are some technical nuances that are worthy of mentioning. Assume a company has a multisig smart contract account as their main address, and 10 key holders for the multisig smart contract (the threshold here does not matter). Each of the key holders were included in the recipients list of the airdrop. In order for the company to receive the airdropped tokens, each of the key holders must claim the tokens by sending a transaction. For normal use of the multisig smart contract (\eg Gnosis Safe), the keyholders do not require a balance to pay for gas, however this transaction requires an onchain transaction and gas. After the claim process is done, the tokens required to be transferred to the main address of the company. This process is cumbersome and requires manual review of the transactions to ensure the correctness of the process. To make the matter more complicated, the airdrop was done in two phases\footnote{There were three consecutive airdrops, however, for the sake of simplicity in this case study, we will focus only on the first two, as the second and third airdrops were technically identical, rendering the examination of the third phase redundant.}, and the second phase was done after the first phase was completed and only airdropped to addresses that have claimed and interacted with the governance of the Optimism protocol~\cite{allen2023airdrop}. The second phase of the airdrop did not need to be claimed and was sent to the eligible addresses, which made the auditing process more complicated and different from the first phase. 

In order to audit the existence of the airdropped tokens, the auditor must ensure that the client has claimed the tokens, the cost of the claim (gas), and the price of the time of the claim, in order to include them in the financial statements. This process is not straightforward and requires manual auditing of the client's Ethereum addresses. Additionally, the auditor must ensure that the client has claimed the tokens before the end of the fiscal year, otherwise the tokens must be excluded from the financial statements. There are many open challenges in this process, as each transfer of tokens requires to be recorded and explained in the audit report. Additionally, many of these airdropped tokens, are not listed on any exchanges or have really low valuation to be considered material, hence the auditor must rely on the client's internal valuation of the tokens.


% Case Study 3:
% —> Excistence 
% OP airdrop —> drop to every keyholder —> required to claim per address
% —> key holders didn't have balance, 
% —> move the balance to main wallet
% —> Ownership —> Time of ownership 
% 	—> Existence —> do they exist in the balance sheet
% —> valuation —> how do you value that?
% ———> Argument : OP if claimed, and voted some governnace, you'd get a second airdrop . how does that work and what is that considered to be? 
% —> Airdrop claim expiry 






\subsection{Case Study 3: Valuation} \label{sec:auditing:case-studies:valuation}
In Section~\ref{sec:auditing:framework:valuation}, we discussed some of the challenges of valuing cryptoassets for financial audits. In this case study, we will depict a future where the auditing frameworks have adapted to the blockchain ecosystem and integrates real-time auditing into the financial audit process. 

In this scenario, the quantity of cryptoassets held by the company is fetched from a blockchain full node independently by the auditors (or any other entity), and the valuation of the cryptoassets is done using the real-time price feed from a decentralized exchange (DEX). 

%TODO: explain on why this is a potential future that we are heading towards and why it is important to discuss it here

In such scenario, the auditing process is more efficient and less prone to errors, as the auditors do not need to rely on the client's internal records for the quantity of the cryptoassets held by the company. Additionally, the valuation of the cryptoassets is done using a decentralized price feed as the oracle (See Chapter~\ref{sec:oracles}). However, this scenario is not without its own challenges. For example, the auditors must ensure that the price feed is reliable and not manipulated. Additionally, the auditors must ensure that the price feed is not delayed, as the price of the cryptoassets can fluctuate significantly in a short period of time. Any mistake in the price feed can result in significant changes in the audit snap shots, which can make the company insolvent for a short period of time. Any oracle manipulation attack, explained further in Chapter~\ref{sec:oracles}, can result in either over or under valuation of the cryptoassets, resulting in an inaccurate financial statement.

% —> valuation: chapter oracle paper: oracle manupulation attack and tell REKT story? maybe no
% —> contributes to your solvency
% —> valuation v.s. oracle manipulation 
% —> realtime valuation v.s. end of the year valuation 
% ——> If we move to realtime auditing, then oracle manipulation attack might be relevant
% 	—> depending on the price feed, it can result in significant changes in the audit snap shots (can make the company insolvant for a short period of time)
% —> realtime audit CITATIONS
% —> tech nueances: price feed, we want decentral trustless price feed —> DEX —> Oracles



\subsection{Case Study 4: Internal Controls \& Monitoring} \label{sec:auditing:case-studies:internalcontrol}
% Case study 4:
% Access Control? if you own a token and that token contract is upgradable, do you have the token forever?

As described in Section~\ref{sec:auditing:framework:internalcontrol}, auditors must be satisfied that the internal controls of the client are effective. This is done by testing the design and operating effectiveness of the internal controls. In the context of cryptoassets, this is challenging because the adequate internal controls are novel to the auditors, and the expertise to evaluate and test theses controls are not always available. Even if the company has acquired their SOC reports, it is still not sufficient to assume the adequacy of the internal controls.

As an example, we will discuss the internal controls of a multisig smart contract. As described in Section~\ref{sec:auditing:background}, multisig smart contracts are commonly used by companies to securely store their cryptoassets. Unlike EOA addresses, smart contracts do not have a private key associated with them, hence the proof of ownership cannot be done using the digital signature verification. Other than the proof of ownership, the internal controls of the multisig smart contract must be evaluated and tested. This process is more complicated as it includes review of the private key generation process, secure backups, the multisig setup, and manual audit of the smart contract code and deployment. Additionally, the smart contract can be upgraded or the signatories of the multisig smart contract can be changed at any time, hence the requirement to put in place a monitoring system to ensure all the stakeholders will be notified of any proposed changes to the multisig smart contract. It should be noted that this monitoring can be done by any entity that has access to the blockchain, and does not necessarily need to be done by the auditors, however, the auditors must ensure that the monitoring is done by the client or a third party.


% Connect this back to why 
% anything on key generation ceremony? 
% —> manual audit and monitoring are needed, timelock? 


% Case Study 2:
% —> key generation ceremony
% — key backups
% —> multisig setup 
% ——> variables 3of3 less secure
% —> On Cryptocurrency Wallet Design PAPER

% —> Key generation ceremony

% =====

%++++++++++++++++++++++=======================================+++++++++++++++++++++
\section{Discussion} \label{sec:auditing:discussion}
% what is the connection between them

% what do you do about it? 
% - formal analysis, static analysic, manual audits
% - within the manual audit, how to do it?
%     - relavant to rest of the chapter
% - pick up on the technical neuances 
%     - How do you expect furture 500 companies to get the details?


% a bunch of papers on washtrading —> volume issue, not really valuation but you can increase the volume, increase the reputation and hence increase the valuation. not really
% —> assets with no liability


%++++++++++++++++++++++=======================================+++++++++++++++++++++
\section{Conclusion} \label{sec:auditing:conclusion}







