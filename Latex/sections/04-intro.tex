% !TEX root = ../main.tex

% new title? The Hidden Layers of Blockchains: Technical Nuances and their Unforeseen Consequences

\chapter{Introduction} \label{sec:intro}


\textblue{Try to write the strongest (without going over the top) introductory paragraph you can. Below commented out is remixed a bit from what you have. It is ok but kind of conventional. What I'd prefer is actually starting with your motivation, I think it is strong, and going from there. Below (not commented out) is my vision for what that could look like.}

%Blockchain technology is important to study because (\textblue{why?}). There are billions of dollars worth of assets stored and transacted on the blockchain, specifically Ethereum blockchain. It has been used for a range of applications. In this dissertation, we will see deployments that include digital cash (\eg Bitcoin~\cite{nakamoto2008bitcoin}), decentralized exchanges (\eg Bancor~\cite{hertzog2017bancor}), crypto-collectibles (\eg CryptoKitties~\cite{cryptokitties}), gambling services (\eg Fomo3D~\cite{fomo3dmedium}), and decentralized governance~\cite{aragonwebsite} (\eg DAO~\cite{wang2019decentralized,siegel2016daohack}).

%\textblue{How does this connect to previous paragraph?} A perception that cryptocurrencies are criminal money has been formed in the public opinion. This perception is not meritless, as there are many cases of fraud and theft in the blockchain space. However, the blockchain technology is not inherently criminal. In fact, the technology has the potential to reduce the fraud rate by providing a transparent and immutable ledger.

%\textblue{Connect to above} The main theme of this dissertation is to analyze a few different types of unforeseen consequences (mainly unethical and criminal activities) that are feasible because of how blockchain technology works and is implemented. As we discuss in the next section, the design of the blockchain technology and the applications of it can enable really novel approaches to remove intermediaries in different businesses. However, this also brings forth some unforeseen consequences that are harmful if not purposefully considered. 



% = = =

In the course of my academic journey, my professional experiences have played a pivotal role in shaping and enriching my research focus. Starting from my role as Blockchain Engineer at \textit{Bitaccess} (a bitcoin ATM company), I learned that Bitcoin is used by some people every day, and these people \textblue{can you say they experience some friction?}. This lead me to explore the technical nuances of different wallets and key management approaches~\cite{eskandari2015real,eskandari2016buy,EBSC15}.

It was during this role that I also noticed that the public perception of cryptocurrencies as criminal money had solidified. This perception is not meritless, as there are many cases of fraud and theft in the blockchain space (\textblue{Can you say something specific about what you saw at Bitaccess}). However, the blockchain technology is not inherently criminal. In fact, the technology has the potential to reduce the fraud rate by providing a transparent and immutable ledger. \textblue{Can you say something about how you implemented anti-fraud measures at Bitaccess?}

 Later on, my role as a security engineer and smart contract auditor at \textit{ConsenSys Diligence} provided me with valuable insights into the nuances of smart contract security. This role was instrumental in deepening my understanding of the technical complexities and interconnections within the blockchain ecosystem and DApps (\ie composability). Engaging closely with the nuances of blockchain technology and their implementations, I developed a comprehensive perspective on its operational frameworks and security paradigms. This has enabled me to look through many common assumptions and their technical nuances that are not obvious to the developers and users alike. \textblue{reword so you don't say `nuance' in every sentence}

As the Chief Technology Officer at \textit{Ether Capital}, a publicly traded entity with significant holdings in cryptoassets, I was exposed to the practicalities of integrating cryptoassets into the established financial ecosystem. This experience was transformative, offering me a first-hand experience to the dialogue, strategies, and implementation processes by real-world companies as they navigate the domain of cryptoassets. It was during this time that I engaged extensively with various financial institutions and auditors, particularly in the context of annual audits and quarterly financial statements. These interactions revealed a significant disconnect between traditional auditing methods and the nuanced requirements of cryptoassets custody and ownership. I observed the overcomplicated and redundant processes that failed to address the core needs of companies and stakeholders in the realm of cryptocurrencies.

Through this thesis, I seek to shed some light on some of these knowledge gaps, and discuss the potential ethical issues and technical solutions to narrow these gaps. A few examples: in chapter~\ref{sec:auditing}, we discuss the challenges of auditing cryptoassets and the disconnect between the traditional auditing methods and the technical expertise required to verify the financial statements. In chapter~\ref{sec:frontrunning}, we discuss how some solutions to share the profit from front-running fall in gray areas of ethics and regulations. In chapter~\ref{sec:cryptojacking}, we discuss the ethical questions surrounding the cryptojacking and how it can be used as a business model to replace the advertisement revenue but due to the policy vacuum fell victim to the bad actors. There are many more examples throughout this thesis that we discuss the ethical and technical nuances of the blockchain technology and its applications.

\section{Contributions and Outline} 

In this dissertation, we discuss the technical nuances of the blockchain technology and its applications, conduct research on their unforeseen consequences that enabled bad actors to profit from unethical use of the technology. The transparency, permissionless, and public aspects of the blockchain enables more actors to participate in the misdeeds, which previously was only limited to a few actors (e.g. brokers in the traditional financial systems). \textblue{Is this it? How about the speed of attack, the irreversible nature, the anonymity, what else?}

In Chapter~\ref{sec:background}, we offer an introduction to the essential concepts necessary for comprehending this dissertation. Each chapter also includes a background section to extend the necessary concepts for the chapter.

In Chapter~\ref{sec:cryptojacking}, we present the first academic study of cryptojacking, covering its fast-paced growth and the ethical questions surrounding this use of the blockchain technology. \textit{Cryptojacking is... } We examine the trend towards in-browser mining of cryptocurrencies; in particular, the mining of Monero through Coinhive and similar services. This technology was introduced as a novel mean for monetizing web content, as a way to replace all the intermediaries in the typical means of advertisement and/or paywalls. In this model, a user visiting a website will seamlessly download a JavaScript code that executes client-side in her browser, mines a cryptocurrency---typically without her consent or knowledge---and pays out the seigniorage to the website. Websites may consciously employ this as an alternative or to supplement advertisement revenue, may offer premium content in exchange for mining, or may be unwittingly serving the code as a result of a breach (in which case the seigniorage is collected by the attacker). The cryptocurrency Monero is preferred seemingly for its unfriendliness to large-scale ASIC mining that would drive browser-based efforts out of the market, as well as for its purported privacy features. We survey this landscape, conduct some measurements to establish its prevalence and profitability, outline an ethical framework for considering whether it should be classified as an attack or business opportunity, and make suggestions for the detection, mitigation and/or prevention of browser-based mining for non-consenting users.


In Chapter~\ref{sec:frontrunning}, we study the front-running attacks on blockchain applications, provide a taxonomy of these attacks, and analyze the common mitigation methods. We consider front-running to be a course of action where an entity benefits from prior access to privileged market information about upcoming transactions and trades. Front-running has been an issue in financial instrument markets since the 1970s. With the advent of the blockchain technology, front-running has resurfaced in new forms we explore here, instigated by blockchain’s decentralized and transparent nature. Due to the public and transparent aspect of blockchains, any actor can act as the privileged actor in the information flow and abuse this early access to information to profit from it. In this chapter, we draw from a scattered body of knowledge and instances of front-running across the top 25 most active decentralized applications (DApps) deployed on Ethereum blockchain. Additionally, we carry out a detailed analysis of \textit{Status.im} initial coin offering (ICO) and show evidence of abnormal miner’s behavior indicative of front-running token purchases. Finally, we map the proposed solutions to front-running into useful categories. Lastly, we discuss the ethical and legal issues that are left unanswered so far.


In Chapter~\ref{sec:oracles}, we study the oracle implementations on the blockchain, and the attacks on blockchain applications that use oracles. \textit{Oracles are.. } One fundamental limitation of blockchain-based smart contracts is that they execute in a closed environment. Thus, they only have access to data and functionality that is already on the blockchain, or is fed into the blockchain. Any interactions with the real world need to be mediated by a bridge service, which is called an \textit{oracle}. As decentralized applications mature, oracles are playing an increasingly prominent role. With their evolution comes more attacks, necessitating greater attention to their trust model. We dissect the design alternatives for oracles, showcase attacks, and discuss attack mitigation strategies.


In Chapter~\ref{sec:auditing}, we study the auditing of blockchain-based assets and the systematic challenges a company (and the auditing firms) might have to properly audit their crypto-assets. Auditing firms are hesitant to accept mandates from companies that hold a significant amount of cryptoassets, primarily because the blockchain sector introduces novel, technically sophisticated, and risky propositions that auditors are unequipped to handle. Abrupt recusals by auditors operating in this sector have led to several enterprises being placed on cease trade by securities regulators for failure to produce audited financial statements on time, thus impeding these companies from raising capital and bringing new investments to fund innovation in this space. In this chapter we critically analyze the purported roadblocks to auditing blockchain firms and map them to traditional auditing practices. We discuss four different case studies and the challenges those solutions bring forth. We urge auditors to reconsider their resistance to the blockchain sector by demonstrating that providing an audit opinion is challenging but not insurmountable.

Lastly, in Chapter~\ref{sec:conclusion}, we provide some concluding remarks and future research prospects.

\section{Additional Publications}
In this section, I present a brief summary of publications I wrote during my doctoral studies that are not directly related to the main theme of this dissertation. These publications are the result of collaborations with other researchers and are not included in the main body of this dissertation.

\begin{itemize}

    \item{The Middleman is Dead, Long Live the Middleman: The “trust factor” and the psycho-social implications of blockchain ~\cite{gaggioli2019middleman}}: Blockchain is widely regarded as a breakthrough innovation that may have a profound impact on the economy and society, of a magnitude comparable to the effects of the introduction of the Internet itself. In essence, a blockchain is a decentralized peer-to-peer network with no central authority figure, which adds information to the distributed database by collectively validating the accuracy of data. Since each node of the network participates in the review and confirmation of the new information before being accepted, the need for a trustworthy intermediary is eliminated. However, as trust plays an essential role in affecting decisions when transacting with one another, it is important to understand which implications the decentralized nature of blockchain may have on individuals' sense of trust. In this contribution, we argue that the adoption of blockchain is not only a technological, but foremostly a psychological challenge, which crucially depends on the possibility of creating a trust management approach that matches the underlying distributed communication system. We first describe the decentralization technologies and possibilities they hold for the near future. Next, we discuss the psycho-social implications of the introduction of decentralized processes of trust, examining some potential scenarios, and outline a research agenda.

    \item{Resolving the multiple withdrawal attack on erc20 tokens~\cite{rahimian2019resolving}:} Custom tokens are an integral component of decentralized applications (DApps) deployed on Ethereum and other blockchain platforms. For Ethereum, the ERC20 standard is a widely used token interface and is interoperable with many existing DApps, user interface platforms, and popular web applications (e.g., exchange services). An ERC20 security issue, known as the multiple withdrawal attack, was raised on GitHub and has been open since October 2017. The issue concerns ERC20's defined method approve() which was envisioned as a way for token holders to give permission for other users and DApps to withdraw a capped number of tokens. The security issue arises when a token holder wants to adjust the amount of approved tokens from N to M (this could be an increase or decrease). If malicious, a user or DApp who is approved for N tokens can front-run the adjustment transaction to first withdraw N tokens, then allow the approval to be confirmed, and withdraw an additional M tokens. In this paper, we evaluate 10 proposed mitigations for these issues and find that no solution is fully satisfactory. We then propose 2 new solutions that mitigate the attack, one of which fully fulfills constraints of the standard, and the second one shows a general limitation in addressing this issue from ERC20’s approve method.

\end{itemize}

